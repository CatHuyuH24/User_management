<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Library Management - Admin Portal</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link href="css/style.css" rel="stylesheet" />
    <style>
      .book-cover {
        width: 60px;
        height: 80px;
        object-fit: cover;
        border-radius: 4px;
      }

      .book-cover-placeholder {
        width: 60px;
        height: 80px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 18px;
      }

      .availability-badge {
        font-size: 0.75rem;
        padding: 0.25rem 0.5rem;
      }

      .genre-badge {
        font-size: 0.7rem;
        padding: 0.2rem 0.4rem;
        margin: 0.1rem;
      }

      .stats-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 15px;
        padding: 1.5rem;
        margin-bottom: 1rem;
      }

      .stats-card.books {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }

      .stats-card.available {
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      }

      .stats-card.borrowed {
        background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
      }

      .stats-card.overdue {
        background: linear-gradient(135deg, #ff6b6b 0%, #ffa500 100%);
      }

      .stats-number {
        font-size: 2.5rem;
        font-weight: bold;
        margin-bottom: 0.5rem;
      }

      .stats-label {
        font-size: 0.9rem;
        opacity: 0.9;
      }

      .action-btn {
        border-radius: 8px;
        margin: 0 2px;
      }

      .filter-section {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 1rem;
        margin-bottom: 1rem;
      }

      .table-container {
        background: white;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .table th {
        background: #f8f9fa;
        border: none;
        font-weight: 600;
        color: #495057;
      }

      .book-info {
        max-width: 300px;
      }

      .book-title {
        font-weight: 600;
        color: #495057;
        margin-bottom: 0.25rem;
      }

      .book-author {
        color: #6c757d;
        font-size: 0.9rem;
      }

      .book-isbn {
        color: #6c757d;
        font-size: 0.8rem;
        font-family: monospace;
      }
    </style>
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="admin-dashboard.html">
          <i class="fas fa-book-open me-2"></i>Library Admin
        </a>

        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link" href="admin-dashboard.html">
                <i class="fas fa-tachometer-alt me-1"></i>Dashboard
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="admin-users.html">
                <i class="fas fa-users me-1"></i>Users
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="admin-library.html">
                <i class="fas fa-books me-1"></i>Library
              </a>
            </li>
          </ul>

          <ul class="navbar-nav">
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarDropdown"
                role="button"
                data-bs-toggle="dropdown"
              >
                <i class="fas fa-user-circle me-1"></i>
                <span id="adminName">Admin</span>
              </a>
              <ul class="dropdown-menu">
                <li>
                  <a class="dropdown-item" href="profile.html">
                    <i class="fas fa-user me-2"></i>Profile
                  </a>
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a class="dropdown-item" href="#" onclick="logout()">
                    <i class="fas fa-sign-out-alt me-2"></i>Logout
                  </a>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container-fluid mt-4">
      <!-- Page Header -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h2><i class="fas fa-books me-2"></i>Library Management</h2>
          <p class="text-muted mb-0">
            Manage books, track loans, and monitor library inventory
          </p>
        </div>
        <div>
          <button class="btn btn-success me-2" onclick="showAddBookModal()">
            <i class="fas fa-plus me-1"></i>Add Book
          </button>
          <button class="btn btn-outline-primary me-2" onclick="exportBooks()">
            <i class="fas fa-download me-1"></i>Export
          </button>
          <button class="btn btn-outline-secondary" onclick="refreshBooks()">
            <i class="fas fa-sync-alt me-1"></i>Refresh
          </button>
        </div>
      </div>

      <!-- Stats Overview -->
      <div class="row mb-4">
        <div class="col-md-3">
          <div class="stats-card books">
            <div class="stats-number" id="totalBooks">-</div>
            <div class="stats-label">Total Books</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="stats-card available">
            <div class="stats-number" id="availableBooks">-</div>
            <div class="stats-label">Available</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="stats-card borrowed">
            <div class="stats-number" id="borrowedBooks">-</div>
            <div class="stats-label">Currently Borrowed</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="stats-card overdue">
            <div class="stats-number" id="overdueBooks">-</div>
            <div class="stats-label">Overdue</div>
          </div>
        </div>
      </div>

      <!-- Filters -->
      <div class="filter-section">
        <div class="row">
          <div class="col-md-3">
            <div class="form-group">
              <label for="searchInput" class="form-label">Search Books</label>
              <div class="input-group">
                <span class="input-group-text">
                  <i class="fas fa-search"></i>
                </span>
                <input
                  type="text"
                  class="form-control"
                  id="searchInput"
                  placeholder="Title, author, or ISBN..."
                />
              </div>
            </div>
          </div>
          <div class="col-md-2">
            <div class="form-group">
              <label for="genreFilter" class="form-label">Genre</label>
              <select
                class="form-select"
                id="genreFilter"
                onchange="applyFilters()"
              >
                <option value="">All Genres</option>
                <option value="Fiction">Fiction</option>
                <option value="Non-Fiction">Non-Fiction</option>
                <option value="Science">Science</option>
                <option value="Technology">Technology</option>
                <option value="History">History</option>
                <option value="Biography">Biography</option>
                <option value="Mystery">Mystery</option>
                <option value="Romance">Romance</option>
                <option value="Fantasy">Fantasy</option>
                <option value="Other">Other</option>
              </select>
            </div>
          </div>
          <div class="col-md-2">
            <div class="form-group">
              <label for="availabilityFilter" class="form-label"
                >Availability</label
              >
              <select
                class="form-select"
                id="availabilityFilter"
                onchange="applyFilters()"
              >
                <option value="">All</option>
                <option value="available">Available</option>
                <option value="borrowed">Borrowed</option>
              </select>
            </div>
          </div>
          <div class="col-md-2">
            <div class="form-group">
              <label for="languageFilter" class="form-label">Language</label>
              <select
                class="form-select"
                id="languageFilter"
                onchange="applyFilters()"
              >
                <option value="">All Languages</option>
                <option value="English">English</option>
                <option value="French">French</option>
                <option value="Spanish">Spanish</option>
                <option value="German">German</option>
                <option value="Other">Other</option>
              </select>
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label for="sortBy" class="form-label">Sort By</label>
              <select class="form-select" id="sortBy" onchange="applyFilters()">
                <option value="title">Title</option>
                <option value="author">Author</option>
                <option value="published_year">Year Published</option>
                <option value="created_at">Date Added</option>
                <option value="available_copies">Availability</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <!-- Books Table -->
      <div class="table-container">
        <div class="table-responsive">
          <table class="table table-hover mb-0">
            <thead>
              <tr>
                <th style="width: 80px">Cover</th>
                <th style="width: 30%">Book Details</th>
                <th style="width: 15%">Genre</th>
                <th style="width: 10%">Language</th>
                <th style="width: 15%">Availability</th>
                <th style="width: 12%">Year</th>
                <th style="width: 18%">Actions</th>
              </tr>
            </thead>
            <tbody id="booksTableBody">
              <!-- Books will be loaded here -->
            </tbody>
          </table>
        </div>

        <!-- Table Footer -->
        <div
          class="d-flex justify-content-between align-items-center p-3 border-top"
        >
          <div class="text-muted">
            Showing <span id="showingStart">1</span> to
            <span id="showingEnd">10</span> of
            <span id="totalBooksCount">0</span> books
          </div>
          <div>
            <nav>
              <ul class="pagination pagination-sm mb-0">
                <li class="page-item">
                  <a class="page-link" href="#" onclick="previousPage()"
                    >Previous</a
                  >
                </li>
                <li class="page-item active">
                  <a class="page-link" href="#"
                    ><span id="currentPageNum">1</span></a
                  >
                </li>
                <li class="page-item">
                  <a class="page-link" href="#" onclick="nextPage()">Next</a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Book Modal -->
    <div class="modal fade" id="addBookModal" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">
              <i class="fas fa-plus me-2"></i>Add New Book
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form
              id="addBookForm"
              onsubmit="event.preventDefault(); addBook();"
            >
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="newTitle" class="form-label">Title *</label>
                    <input
                      type="text"
                      class="form-control"
                      id="newTitle"
                      required
                    />
                    <div class="invalid-feedback"></div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="newAuthor" class="form-label">Author *</label>
                    <input
                      type="text"
                      class="form-control"
                      id="newAuthor"
                      required
                    />
                    <div class="invalid-feedback"></div>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="newISBN" class="form-label">ISBN</label>
                    <input
                      type="text"
                      class="form-control"
                      id="newISBN"
                      placeholder="978-0-123456-78-9"
                    />
                    <div class="invalid-feedback"></div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="newPublisher" class="form-label"
                      >Publisher</label
                    >
                    <input type="text" class="form-control" id="newPublisher" />
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-4">
                  <div class="mb-3">
                    <label for="newGenre" class="form-label">Genre *</label>
                    <select class="form-select" id="newGenre" required>
                      <option value="">Select Genre</option>
                      <option value="Fiction">Fiction</option>
                      <option value="Non-Fiction">Non-Fiction</option>
                      <option value="Science">Science</option>
                      <option value="Technology">Technology</option>
                      <option value="History">History</option>
                      <option value="Biography">Biography</option>
                      <option value="Mystery">Mystery</option>
                      <option value="Romance">Romance</option>
                      <option value="Fantasy">Fantasy</option>
                      <option value="Other">Other</option>
                    </select>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="mb-3">
                    <label for="newLanguage" class="form-label"
                      >Language *</label
                    >
                    <select class="form-select" id="newLanguage" required>
                      <option value="">Select Language</option>
                      <option value="English">English</option>
                      <option value="French">French</option>
                      <option value="Spanish">Spanish</option>
                      <option value="German">German</option>
                      <option value="Other">Other</option>
                    </select>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="mb-3">
                    <label for="newPublishedYear" class="form-label"
                      >Published Year</label
                    >
                    <input
                      type="number"
                      class="form-control"
                      id="newPublishedYear"
                      min="1000"
                      max="2024"
                      placeholder="2023"
                    />
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="newTotalCopies" class="form-label"
                      >Total Copies *</label
                    >
                    <input
                      type="number"
                      class="form-control"
                      id="newTotalCopies"
                      min="1"
                      value="1"
                      required
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="newCoverUrl" class="form-label"
                      >Cover Image URL</label
                    >
                    <input
                      type="url"
                      class="form-control"
                      id="newCoverUrl"
                      placeholder="https://example.com/cover.jpg"
                    />
                  </div>
                </div>
              </div>

              <div class="mb-3">
                <label for="newDescription" class="form-label"
                  >Description</label
                >
                <textarea
                  class="form-control"
                  id="newDescription"
                  rows="3"
                  placeholder="Brief description of the book..."
                ></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button type="button" class="btn btn-success" onclick="addBook()">
              <i class="fas fa-plus me-1"></i>Add Book
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>

    <!-- Alert Container -->
    <div id="alertContainer" class="alert-container"></div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/common.js"></script>
    <script src="js/admin-library.js"></script>
  </body>
</html>
